<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <style>body {
        position: relative;
        font-size: 100%;
        height: 100vh;
        margin: 0 auto;
        background-color: #d8dcf4;
        animation: gradientAnimation 13s ease infinite;
        background: linear-gradient(-45deg, #AF8DEB, #C78AE3, #DE8AC7, #E38AA1);
        background-size: 400% 400%;
    }
    
    @keyframes gradientAnimation {
        0% {
            background-position: 0% 50%;
        }
    
        50% {
            background-position: 100% 50%;
        }
    
        100% {
            background-position: 0% 50%;
        }
    }
    
    header {
        width: 1050px;
        height: 10%;
        border-bottom: 2px solid black;
        margin-left: auto;
        margin-right: auto;
    }
    
    #wrap {
        position: relative;
        height: 100vh;
    }
    
    section {
        position: absolute;
        height: 80vh;
    }
    
    footer {
        position: absolute;
        height: 10vh;
        width: 100%;
        top: 90%;
    }
    
    table {
        position: absolute;
        border-collapse: collapse;
        background-color: #AF8DEB;
        width: 80%;
    }
    
    tr {}
    
    .table_head {
        height: 50px;
    }
    
    #th_select_product {
        width: 20px;
    }
    
    tr>.td_product_select {
        width: 20px;
    }
    
    #th_product_information {
        text-align: left;
        padding-left: 50px;
    }
    
    th {
        border-bottom: 2px solid black;
        width: 120px;
    }
    
    td {
        border-bottom: 2px solid black;
        font-weight: bolder;
    }
    
    input {
        font-weight: bold;
    }
    
    a:link,
    a:visited {
        color: #ebedfa;
        text-decoration-line: none;
    }
    
    .logo {
        float: left;
        padding: 20px 0 10px;
        font-size: 40px;
        width: 100%;
        text-align: center;
    }
    
    .contents_cart {
        position: relative;
    }
    
    .cart_top {
        position: absolute;
        border: 2px solid skyblue;
        border-radius: 50%;
        font-size: 30px;
        text-align: left;
        height: 7%;
        width: 11%;
        left: 10%;
    }
    
    .cart_top>span {
        font-weight: bolder;
        padding-left: 5%;
    }
    
    .cart_top>span>img {
        position: absolute;
        margin-left: 10px;
        top: 2%;
        width: 40px;
        height: 40px;
    }
    
    .cart_content {
        position: relative;
        border: 5px solid red;
    }
    
    .cart_table {
        position: absolute;
        top: 10%;
        left: 10%;
    }
    
    .td_body {
        text-align: center;
    }
    
    .product_information {
        text-align: center;
        font-size: 12px;
        font-weight: bolder;
    }
    
    .product_image {
        margin-top: 5px;
        width: 100px;
        height: 100px;
        transition: all 1s;
    }
    
    .product_image:hover {
        transform: scale(1.2);
        border-radius: 30%;
    }
    
    .product_option_list {
        font-weight: bold;
    }
    
    #product_amount {
        text-align: center;
        width: 15px;
    }
    
    .product_amount {
        text-align: center;
        width: 15px;
    }
    
    #order_table_select {
        position: absolute;
        font-size: 1.2em;
        font-weight: 900;
        top: 80%;
        left: 10%;
    }
    
    #order_total_product {
        position: absolute;
        width: 20%;
        top: 80%;
        left: 70%;
    }
    
    .total_product_information {
        font-size: 15px;
        font-weight: bolder;
        height: 100%;
    }
    
    #cart_order {
        position: absolute;
        font-size: 1.2em;
        text-align: center;
        vertical-align: middle;
        width: 100%;
        height: 30%;
        border-bottom: none;
    }
    
    #cart_order>a {
        position: absolute;
        left: -1.5%;
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    #delete_product,
    #delete_product:hover {
        color: salmon;
        cursor: pointer;
    }
    
    .btn {
        background-color: #fff;
        border: 2px solid #7e87c4;
        border-radius: 5px;
        font-weight: bolder;
    }
    
    .btn:hover {
        color: white;
        background-color: skyblue;
    }
    
    .total_product_price_information {
        position: relative;
        list-style: none;
        line-height: 2em;
        font-size: 35px;
    }
    
    .total_product_div {
        border-bottom: 2px solid #ebedfa;
        font-size: 1.2em;
        color: white;
    }
    
    .total_product_div>span {
        width: 100px;
    }
    
    #total_price {
        margin: 20%;
    }
    
    #sub_total_price {
        margin: 35%;
    }
    
    #delivery_fee {
        margin: 35%;
    }
    
    .order_price {
        text-align: right;
        margin: 30%;
    }
    
    .order_button {
        display: inline-block;
        border-radius: 4px;
        background-color: #6276f4;
        border: none;
        color: #FFFFFF;
        text-align: center;
        font-size: 20px;
        padding: 10px;
        width: 200px;
        transition: all 0.5s;
        cursor: pointer;
        margin: 5px;
    }
    
    .order_button span {
        cursor: pointer;
        display: inline-block;
        position: relative;
        transition: 0.5s;
    }
    
    .order_button span:after {
        content: '\00bb';
        position: absolute;
        opacity: 0;
        top: 0;
        right: -20px;
        transition: 0.5s;
    }
    
    .order_button:hover span {
        padding-right: 25px;
    }
    
    .order_button:hover span:after {
        opacity: 1;
        right: 0;
    }
    
    .modal {
        background: #fff;
        border-radius: 4px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        padding: 20px;
        max-width: 400px;
        width: 50%;
        text-align: center;
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
      }
    
      .modal h2 {
        margin-top: 0;
      }
    
      .modal-buttons {
        margin-top: 20px;
      }
    
      .modal-buttons button {
        margin: 0 10px;
        padding: 10px 20px;
        border-radius: 4px;
        border: none;
        font-size: 16px;
        cursor: pointer;
      }
    
      .modal-buttons button.yes {
        background: #df66df;
        color: #fff;
      }
      .modal-buttons button.yes:hover{
        background: #de52de;
      }
      .modal-buttons button.no {
        background: #9e32c5;
        color: #fff;
      }
      .modal-buttons button.no:hover{
        background: #9a1ec7;
      }
      .hidden {
        display: none;
      }</style>
</head>

<body>
    <div id="wrap">
        <header>
            <div class="logo"><a href="#"><span>Home</span></a></div>
        </header>
        <section id="contents_cart" class="contents_cart">
            <!-- <section class="cart_title">
                <h1 class="sr-only">장바구니</h1>
            </section> -->
            <div id="cart_content">
                <div class="cart_top"><span>My Cart<img src="../Image/cart.png" alt=""></span></div>

                <table class="cart_table">
                    <colgroup>
                        <col width="50"> <!--전체 선택-->
                        <col width="100"> <!--상품 정보-->
                        <col width="100">
                        <col width="100"> <!--상품 수량-->
                        <col width="100"> <!--상품 가격-->
                    </colgroup>
                    <thead class="table_head">
                        <tr class="head all_select_product" scope="col">
                            <th scope="colgroup" id="th_select_product"><span>Select Product</span></th>
                            <th scope="colgroup" id="th_product_information" colspan="2">Product Infromation</th>
                            <th scope="colgroup" id="th_product_option">Options</th>
                            <th scope="colgroup" id="th_product_amount">Amount</th>
                            <th scope="colgroup" id="th_product_price">Price</th>
                        </tr>
                    </thead>
                    <tbody class="td_body">
                        <tr id="product_1" class="table_row">
                            <td class="td_product_select">
                                <label><input title="상품 선택" type="checkbox" name="product" id="product_checkbox_1"
                                        class="product_select" onclick="checkSelectAll(); totalPriceCalculate();"
                                        checked></label>
                            </td>
                            <td class="td_product_image">
                                <a href="#"><img class="product_image" src="../Image/assets/atomheartmother.png" alt="상품 이미지"></a>
                            </td>
                            <td class="td_product_information">
                                <div class="product_information">atomheartmother</div>
                            </td>
                            <td class="td_product_option">
                                <label for="product_option">
                                    <select name="productOption" class="product_option_list">
                                        <option value="size_white" selected>White</option>
                                        <option value="size_black">Black</option>
                                        <option value="size_silver">Silver</option>
                                        <option value="size_violet">Violet</option>
                                        <option value="size_gold">Gold</option>
                                    </select>
                                </label>
                            </td>
                            <td class="td_product_amount">
                                <label class=product_amount for="product_amount">
                                    <button id="plus_product_1" class="btn product_plus_amount"
                                        onclick="addAmount(event)">⬆</button>
                                    <span id="product_amount_1" class="product_amount_text">1</span>
                                    <button id="minus_product_1" class="btn product_minus_amount"
                                        onclick="minusAmount(event)">⬇</button>
                                </label>
                            </td>
                            <td class="td_product_price"><span class="product_price_text">14,000</span></td>
                        </tr>
                        <tr id="product_2" class="table_row">
                            <td class="td_product_select">
                                <label><input title="상품 선택" type="checkbox" name="product" id="product_checkbox_2"
                                        class="product_select" onclick="checkSelectAll(); totalPriceCalculate();"
                                        checked></label>
                            </td>
                            <td class="td_product_image">
                                <a href="#"><img class="product_image" src="../Image/assets/avobath.png" alt="상품 이미지"></a>
                            </td>
                            <td class="td_product_information">
                                <div class="product_information">avobath</div>
                            </td>
                            <td class="td_product_option">
                                <label for="product_option">
                                    <select name="productOption" class="product_option_list">
                                        <option value="size_white" selected>White</option>
                                        <option value="size_black">Black</option>
                                        <option value="size_silver">Silver</option>
                                        <option value="size_violet">Violet</option>
                                        <option value="size_gold">Gold</option>
                                    </select>
                                </label>
                            </td>
                            <td class="td_product_amount">
                                <label for="product_amount">
                                    <button id="plus_product_2" class="btn product_plus_amount"
                                        onclick="addAmount(event)">⬆</button>
                                    <span id="product_amount_2" class="product_amount_text">1</span>
                                    <button id="minus_product_2" class="btn product_minus_amount"
                                        onclick="minusAmount(event)">⬇</button>
                                </label>
                            </td>
                            <td class="td_product_price"><span class="product_price_text">14,000</span></td>
                        </tr>
                        <tr id="product_3" class="table_row">
                            <td class="td_product_select">
                                <label><input title="상품 선택" type="checkbox" name="product" id="product_checkbox_3"
                                        class="product_select" onclick="checkSelectAll(); totalPriceCalculate();"
                                        checked></label>
                            </td>
                            <td class="td_product_image">
                                <a href="#"><img class="product_image" src="../Image/assets/bigblue.png" alt="상품 이미지"></a>
                            </td>
                            <td class="td_product_information">
                                <div class="product_information">bigblue</div>
                            </td>
                            <td class="td_product_option">
                                <label for="product_option">
                                    <select name="productOption" class="product_option_list">
                                        <option value="size_white" selected>White</option>
                                        <option value="size_black">Black</option>
                                        <option value="size_silver">Silver</option>
                                        <option value="size_violet">Violet</option>
                                        <option value="size_gold">Gold</option>
                                    </select>
                                </label>
                            </td>
                            <td class="td_product_amount">
                                <label for="product_amount">
                                    <button id="plus_product_3" class="btn product_plus_amount"
                                        onclick="addAmount(event)">⬆</button>
                                    <span id="product_amount_3" class="product_amount_text">1</span>
                                    <button id="minus_product_3" class="btn product_minus_amount"
                                        onclick="minusAmount(event)">⬇</button>
                                </label>
                            </td>
                            <td class="td_product_price"><span class="product_price_text">19,000</span></td>
                        </tr>
                        <tr id="product_4" class="table_row">
                            <td class="td_product_select">
                                <label><input title="상품 선택" type="checkbox" name="product" id="product_checkbox_4"
                                        class="product_select" onclick="checkSelectAll(); totalPriceCalculate();"
                                        checked></label>
                            </td>
                            <td class="td_product_image">
                                <a href="#"><img class="product_image" src="../Image/assets/blackrose.png" alt="상품 이미지"></a>
                            </td>
                            <td class="td_product_information">
                                <div class="product_information">blackrose</div>
                            </td>
                            <td class="td_product_option">
                                <label for="product_option">
                                    <select name="productOption" class="product_option_list">
                                        <option value="size_white" selected>White</option>
                                        <option value="size_black">Black</option>
                                        <option value="size_silver">Silver</option>
                                        <option value="size_violet">Violet</option>
                                        <option value="size_gold">Gold</option>
                                    </select>
                                </label>
                            </td>
                            <td class="td_product_amount">
                                <label for="product_amount">
                                    <button id="plus_product_4" class="btn product_plus_amount"
                                        onclick="addAmount(event)">⬆</button>
                                    <span id="product_amount_4" class="product_amount_text">1</span>
                                    <button id="minus_product_4" class="btn product_minus_amount"
                                        onclick="minusAmount(event)">⬇</button>
                                </label>
                            </td>
                            <td class="td_product_price"><span class="product_price_text">20,000</span></td>
                        </tr>
                    </tbody>
                </table>
                <div id="order_table_select">
                    <div class="select_product">
                        <label><input title="모든 상품 선택" type="checkbox" name="selectAll" class="select_all_product"
                                onclick="selectAll(this)" checked>
                            <span>SelectAll</span>
                            <span class="cart_count_button"></span>
                        </label>
                        <span id="delete_product" onclick="deleteSelectProduct();">Delete</span>
                    </div>
                </div>
                <div id="order_total_product">
                    <div class="total_product_information">
                        <div id="sub_total" class="total_product_div">
                            <span>SubTotal</span>
                            <span id="sub_total_price" class="order_price" onchange="changeProductPrice()">6,589,000<span>&nbsp;\</span></span>
                        </div>
                        <div id="delivery" class="total_product_div">
                            <span>Delivery Fee</span>
                            <span id="delivery_fee" class="order_price" onchange="changeProductPrice()">0<span>&nbsp;\</span></span>
                        </div>
                        <div id="total" class="total_product_div">
                            <span>Total</span>
                            <span id="total_price" class="order_price" onchange="changeProductPrice()"><span>&nbsp;\</span></span>
                        </div>
                        <div id="cart_order" class="total_product_div">
                            <button class="order_button" onclick="openModal()"><span>Order</span></button>
                        </div>
                        <div id="modal" class="modal hidden">
                            <h2>주문 확인</h2>
                            <p>결제 페이지로 이동하시겠습니까?</p>
                            <div class="modal-buttons">
                              <button class="yes" onclick="redirectToPayment()">예</button>
                              <button class="no" onclick="closeModal()">아니오</button>
                            </div>
                          </div>
                        
                          <script>
                            function openModal() {
                              document.getElementById('modal').classList.remove('hidden');
                            }
                        
                            function closeModal() {
                              document.getElementById('modal').classList.add('hidden');
                            }
                        
                            function redirectToPayment() {
                              window.location.href = '../payments/payments.html';
                              console.log('결제 페이지로 이동');
                            }
                          </script>
                    </div>
                </div>
            </div>
        </section>
        <!-- <footer>
            <div class="foot">footer</div>
        </footer> -->
    </div>
</body>
<script>
    window.onload = () => {
    totalPriceCalculate();
}
const addAmount = (event) => {
    // const productsList = document.getElementsByClassName("table_row");
    // console.log(productsList.length); // 다음에 추가할 때 product_(length+1)
    const btnId = event.target.id.split('_');
    const productId = btnId[2];
    
    const amount = document.getElementById(`product_amount_${productId}`);

    const checkBox = document.querySelectorAll("input[name=product]");
    // 체크가 안되어 있는데 상품 수량을 변경할 경우 체크 해줌 / 상품 인덱스는 1부터 시작하므로 checkBox의 인덱스는 productId - 1
    if (checkBox[productId - 1].checked === false) {
        checkBox[productId - 1].checked = true;
        checkSelectAll();
    }
    amount.innerHTML = parseInt(amount.innerHTML) + 1;
    // 총 금액 변경
    totalPriceCalculate();
}

const minusAmount = (event) => {
    const btnId = event.target.id.split('_');
    const productId = btnId[2];
    
    const amount = document.getElementById(`product_amount_${productId}`);

    const checkBox = document.querySelectorAll("input[name=product]");
    // 체크가 안되어 있는데 상품 수량을 변경할 경우 체크 해줌 / 상품 인덱스는 1부터 시작하므로 checkBox의 인덱스는 productId - 1
    if (checkBox[productId - 1].checked === false) {
        checkBox[productId - 1].checked = true;
        checkSelectAll();
    }
    if (amount.innerHTML <= 0) {
        alert("수량이 0보다 작습니다.");
    }
    else {
        amount.innerHTML = parseInt(amount.innerHTML) - 1;
        if (amount.innerHTML == 0) {
            checkBox[productId - 1].checked = false;
            checkSelectAll();
        }
        // 총 금액 변경
        totalPriceCalculate();
    }
}

const totalPriceCalculate = () => {
    const productsList = document.getElementsByClassName("table_row");

    let selectProductPrice = 0;
    let checkBoxes = document.querySelectorAll("input[name=product]:checked");
    checkBoxes.forEach((checkBox) => {
        // 상품 아이디 가져오기
        const productId = checkBox.id.split('_')[2];

        let productPrice = productsList[productId - 1].children[5].innerHTML.split(/>|</)[2]
        // productPrice.split(',').join('');
        productPrice = productPrice.replace(/,/g, '');

        // 상품 수량 가져오기
        let productAmount = document.getElementById(`product_amount_${productId}`);

        // 총 금액 = 상품 수량 * 상품 가격
        selectProductPrice += parseInt(productPrice) * parseInt(productAmount.innerHTML);
    })

    // 배송비 
    let deliveryFee = document.getElementById("delivery_fee");
    if (selectProductPrice > 50000 || selectProductPrice == 0) {
        deliveryFee.innerHTML = "0<span>&nbsp;\\</span>";
    } else {
        deliveryFee.innerHTML = "3,000<span>&nbsp;\\</span>";
    }

    let subTotalPrice = document.getElementById("sub_total_price");
    let totalPrice = document.getElementById("total_price");
    subTotalPrice.innerHTML = selectProductPrice.toLocaleString() + "<span>&nbsp;\\</span>";
    totalPrice.innerHTML = (parseInt(deliveryFee.innerHTML.split(',').join('')) + selectProductPrice).toLocaleString() + "<span>&nbsp;\\</span>";
}

const checkSelectAll = () => {
    // 모든 체크박스
    const checkBoxes = document.querySelectorAll('input[name="product"]');

    // 선택된 체크박스
    const checked = document.querySelectorAll('input[name="product"]:checked');

    // 전체 선택 체크박스
    const selectAll = document.querySelector('input[name="selectAll"]');

    // 모든 체크박스(선택됨)와 선택된 체크박스의 길이가 같으면  
    if (checkBoxes.length === checked.length) {
        //전체 선택 체크박스 체크
        selectAll.checked = true;
    } else {
        // 전체 선택 체크박스 해제
        selectAll.checked = false;
    }
    totalPriceCalculate();
}

const selectAll = (selectBox) => {
    // selectBox 가 check 되어 있으면 true, 아니면 false
    const checkBoxes = document.getElementsByName('product');
    checkBoxes.forEach((checkBox) => {
        checkBox.checked = selectBox.checked;
    })
    totalPriceCalculate();
}

const deleteSelectProduct = () => {
    // 체크된 productList 가져오기
    const checkedProductsList = document.querySelectorAll('input[name=product]:checked');
    const productRowList = document.querySelectorAll(".table_row");
    const productIdList = [];
    // productId 가져오기
    checkedProductsList.forEach((productInfo) => {
        productIdList.push(productInfo.id.split('_')[2]);
    })
    productIdList.forEach((productId) => {
        productRowList[productId-1].innerHTML = "";
    })
    totalPriceCalculate();
}

const changeProductPrice = () => {
    const orderPrices = document.querySelectorAll(".order_price");
    console.log(orderPrices[0]);
}


</script>
</html>